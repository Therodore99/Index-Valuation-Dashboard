# 恒生科技指数：近1年区间位置展示（V1）

## 一、目标

用 Python 编写一个最小可运行脚本，模仿截图中的展示形式：

以“区间最低值 — 当前值 — 区间最高值”的横向刻度方式，
展示恒生科技指数（HS Tech）当前指数值在近1年历史区间中的相对位置。

视觉效果参考：
- 一条横线表示近一年区间
- 左侧标注区间最低值
- 右侧标注区间最高值
- 中间用红点标注当前值
- 标注具体数值

目标是实现一个可运行的单指数版本（恒生科技）。

---

## 二、数据

### 指数
- 恒生科技指数（HS Tech）
- 数据通过 iFinD HTTP API 1.0 获取
- 我拥有 API 权限，可提供 access_token

### 时间范围
- 近1年（从当前日期往前365天）
- 若交易日不足365天，使用实际返回交易日

### 指标
- 指数收盘价（或指数最新值）
- 不使用 PE/PB
- 仅使用指数点位

---

## 三、数据逻辑

需要获取：

1. 近1年每日指数值时间序列
2. 计算：
   - 区间最低值
   - 区间最高值
   - 距当前日期最近一个交易日的指数值（视为当前值）
3. 计算当前值在区间中的位置比例：

   position = (current - min) / (max - min)

---

## 四、输出（命令行）

运行：

python 指数项目.py

输出内容格式：

----------------------------------------
恒生科技指数（近1年区间位置）
数据区间: 2025-02-19 ~ 2026-02-19
样本数量: 252

区间最低值: xxxx.xx
区间最高值: xxxx.xx
当前指数值: xxxx.xx
区间位置比例: xx.xx%
----------------------------------------

---

## 五、图表输出（保存到 outputs/）

生成一张图片：

文件名：
outputs/hstech_1y_position.png

样式要求：

- 横向区间线（粗线）
- 左端标注最低值（蓝色）
- 右端标注最高值（橙色）
- 当前值用红色圆点表示
- 当前值上方标注数值
- 标题：恒生科技指数近一年区间位置
- 图片风格简洁、专业、适合公众号发布

不需要做多指数版本。

---

## 六、目录结构

项目目录：

idea_project/
  ├── 指数项目.py
  ├── SPEC.md
  ├── data/
  ├── outputs/
  └── logs/

---

## 七、约束

- 仅实现单指数版本
- 不做网页
- 不做数据库
- 数据需缓存到 data/hstech_1y.csv
- 若缓存存在且为1天内生成，优先使用缓存
- 若 HTTP API 请求失败，输出明确报错信息

---

## 八、可扩展性预留

代码应结构化为函数：

- fetch_data()
- calculate_metrics()
- generate_chart()
- main()

方便未来扩展到多指数版本。
